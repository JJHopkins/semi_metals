#!/usr/bin/env python
import sys
import numpy as np
from scipy.integrate import romb
import matplotlib.pyplot as pl
# use pyreport -l file.py
from pylab import show

filename0=sys.argv[0]
print filename0

A0_CG = np.loadtxt('data/93alCG/A0_93alCG.txt')
A2_CG = np.loadtxt('data/93alCG/A2_93alCG.txt')
T_CG  = np.loadtxt('data/93alCG/T_93alCG.txt')
G_CG  = np.loadtxt('data/93alCG/G_93alCG.txt')

A0_93 = np.loadtxt('data/93al93/A0_93al93.txt')
A2_93 = np.loadtxt('data/93al93/A2_93al93.txt')
T_93  = np.loadtxt('data/93al93/T_93al93.txt')
G_93  = np.loadtxt('data/93al93/G_93al93.txt')

# Constants
r_1 = 0.5e-9
r_2 = 0.5e-9
#thetas = [0.78,0.785,0.79]#np.pi/2
thetas = np.linspace(0.1,3.1,301)
#thetas = np.linspace(0.1,1.50,141)
c = 2.99e8              # [m/s]
coeff = 2.411e14        # [rad/s]
Temp = 300.              # [K] 
kbT = Temp * 1.3807e-23 # [J]

# Matsubara frequencies
ns = np.arange(0.,500.) 
zs = ns * coeff         

Ls = np.arange(1e-9,106e-9,5e-9)  # separation distance between 2 cyclinders

pl.figure()
pl.plot(1e9*Ls,1e21*G_93[:,  0],'b-')
pl.plot(1e9*Ls,1e21*G_93[:, 50],'b-')
pl.plot(1e9*Ls,1e21*G_93[:,100],'b-')
pl.plot(1e9*Ls,1e21*G_CG[:,  0],'r-')
pl.plot(1e9*Ls,1e21*G_CG[:, 50],'r-')
pl.plot(1e9*Ls,1e21*G_CG[:,100],'r-')
pl.title('Free energy vs separation')
pl.show()

pl.figure()
pl.plot(thetas,1e21*G_93[0,:],'b-')
pl.plot(thetas,1e21*G_93[1,:],'b-')
pl.plot(thetas,1e21*G_93[2,:],'b-')
pl.plot(thetas,1e21*G_CG[0,:],'r-')
pl.plot(thetas,1e21*G_CG[1,:],'r-')
pl.plot(thetas,1e21*G_CG[2,:],'r-')
pl.title('Free energy vs mutual angle')
pl.show()

#pl.figure()
#pl.loglog(thetas,1e21*G[0,:])
#pl.loglog(thetas,1e21*G[1,:])
#pl.loglog(thetas,1e21*G[2,:])
#pl.title('Free energy vs mutual angle')
#pl.show()

pl.figure()
#pl.plot(thetas,1e21*T_93[0,:],'b-')
pl.plot(thetas,1e21*T_93[1,:],'b-', label = r'$\tau_{\rm {93al93}}$')
#pl.plot(thetas,1e21*T_93[2,:],'b-')
#pl.plot(thetas,1e21*T_CG[0,:],'r-')
pl.plot(thetas,1e21*T_CG[1,:],'r-', label = r'$\tau_{\rm {93alCG}}$')
pl.plot(thetas,T_CG[2,:]-T_CG[2,:],'k:')
pl.legend(loc='best')
pl.ylabel(r'$Torque$')
pl.xlabel(r'$\theta\,\,\,[rad]$')
pl.title('Torque vs mutual angle')
pl.axis([0,3.2,-0.02,0.02])
pl.savefig('plots/140909_93alCG_93al93_neg_pos_torques.pdf')
#pl.show()
#pl.figure()
#pl.loglog(thetas,1e21*Tau[0,:])
#pl.loglog(thetas,1e21*Tau[1,:])
#pl.loglog(thetas,1e21*Tau[2,:])
#pl.title('Torque vs mutual angle')
#pl.show()

pl.figure()
pl.plot(1e9*Ls,1e21*T_93[:,0],'b-')
pl.plot(1e9*Ls,1e21*T_93[:,1],'b-')
pl.plot(1e9*Ls,1e21*T_93[:,2],'b-')
pl.plot(1e9*Ls,1e21*T_CG[:,0],'r-')
pl.plot(1e9*Ls,1e21*T_CG[:,1],'r-')
pl.plot(1e9*Ls,1e21*T_CG[:,2],'r-')
pl.title('Torque vs separation')
pl.show()

#pl.figure()
#pl.plot(Ls,sum_A0/(sum_A0+sum_A2), 'b-', label = r'$A^{0}(\ell)/A$')
#pl.plot(Ls,sum_A2/(sum_A0+sum_A2), 'r-', label = r'$A^{2}(\ell)/A$')
#pl.plot(Ls,sum_A2-sum_A2, 'k:')
#pl.plot(Ls,sum_A2/sum_A2, 'k:')
#pl.legend(loc = 'best')
#pl.title(r'Ratio of A0,A2 to A =(A0+A2)')
#pl.ylabel(r'$\mathcal{A}^{(0)}/\mathcal{A}, \,\, \mathcal{A}^{(2)}/\mathcal{A}$')
#pl.xlabel(r'$\ell\,\,\,[nm]$')
#pl.show()

pl.figure()
pl.plot(1e9*Ls,1e21*A0_93, 'b-' , label = r'$A^{0}_{\rm 93al93}$')
pl.plot(1e9*Ls,1e21*A2_93, 'b--', label = r'$A^{2}_{\rm 93al93}$')
pl.plot(1e9*Ls,1e21*A0_CG, 'r-' , label = r'$A^{0}_{\rm 93alCG}$')
pl.plot(1e9*Ls,1e21*A2_CG, 'r--', label = r'$A^{2}_{\rm 93alCG}$')
pl.plot(1e9*Ls,(A2_93-A2_93), 'k:')
pl.legend(loc = 'best')
pl.title(r'Hamaker Coeffs vs separation')
pl.ylabel(r'$\mathcal{A}^{(0)}, \,\, \mathcal{A}^{(2)}$')
pl.xlabel(r'$\ell\,\,\,[nm]$')
pl.savefig('plots/140909_93alCG_93al93_Hamakers_vs_ell.pdf')
pl.show()

sys.exit()
pl.figure()
pl.loglog(ns,(kbT/(32.)) * A2[0,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,(kbT/(32.)) * A2[1,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,(kbT/(32.)) * A2[2,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,(kbT/(32.)) * A2[3,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
#pl.title(r'93w93 Matsubara terms')
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
#pl.savefig('plots/24w293_diff_delta2g2__A_vs_n.pdf')
pl.show()
#
pl.figure()
pl.plot(ns,(kbT/(32.)) * A2[0,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.plot(ns,(kbT/(32.)) * A2[1,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.plot(ns,(kbT/(32.)) * A2[2,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.plot(ns,(kbT/(32.)) * A2[3,:], 'b:', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.legend(loc = 'best')
#pl.title(r'93w93 Matsubara terms')
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
#pl.savefig('plots/93_A_vs_n.pdf')
#pl.savefig('plots/24w93_nonlog_compare_delta2g2__A_terms_vs_n.pdf')
pl.show()
#
pl.figure()
pl.plot(ns,(kbT/(32.)) * A0[0,:], 'b-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.plot(ns,(kbT/(32.)) * A0[1,:], 'g-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.plot(ns,(kbT/(32.)) * A0[2,:], 'r-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.plot(ns,(kbT/(32.)) * A0[3,:], 'y-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.plot(ns,(kbT/(32.)) * A2_org[0,:], 'b:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.plot(ns,(kbT/(32.)) * A2_org[1,:], 'g:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.plot(ns,(kbT/(32.)) * A2_org[2,:], 'r:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.plot(ns,(kbT/(32.)) * A2_org[3,:], 'y:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.legend(loc = 'best')
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
#pl.savefig('plots/24w93_nonlog_A_terms_vs_n.pdf')
pl.show()

pl.figure()
pl.loglog(ns,(kbT/(32.)) * A0[0,:], 'b-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,(kbT/(32.)) * A0[1,:], 'g-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,(kbT/(32.)) * A0[2,:], 'r-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,(kbT/(32.)) * A0[3,:], 'y-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.loglog(ns,(kbT/(32.)) * A2[0,:], 'b:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,(kbT/(32.)) * A2[1,:], 'g:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,(kbT/(32.)) * A2[2,:], 'r:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,(kbT/(32.)) * A2[3,:], 'y:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.legend(loc = 'best')
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
#pl.savefig('plots/24w93_A_vs_n.pdf')
pl.show()

pl.figure()
pl.loglog(ns,(kbT/(32.)) * A2[ 0,:],'b-',label=r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,(kbT/(32.)) * A2[ 5,:],'g-',label=r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[5]))
pl.loglog(ns,(kbT/(32.)) * A2[10,:],'r-',label=r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[10]))
pl.loglog(ns,(kbT/(32.)) * A2[22,:],'c:')#, label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,(kbT/(32.)) * A2[24,:],'c-',label =r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[24]))
pl.loglog(ns,(kbT/(32.)) * A2[22,:],'c:')#, label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,(kbT/(32.)) * A2[47,:],'y:')#, label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,(kbT/(32.)) * A2[49,:],'y-',label =r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[49]))
pl.loglog(ns,(kbT/(32.)) * A2[51,:],'y:')#, label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.loglog(ns,(kbT/(32.)) * A2[99,:],'m-',label =r'$A^{(2)}(\ell=%2.1f\,nm)$'%(1e9*Ls[99]))
#
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(2)}_{n}$')
#pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
pl.legend(loc = 'best')
pl.axis([1.88,234.88,2.5e-36,1e-23])
#pl.savefig('plots/24w93_A_vs_n.pdf')
pl.show()
#
#
pl.figure()
pl.loglog(ns,A0[0,:]/sum_A0[0], 'b-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,A0[1,:]/sum_A0[1], 'g-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,A0[2,:]/sum_A0[2], 'r-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,A0[3,:]/sum_A0[3], 'y-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.loglog(ns,A2[0,:]/sum_A2[0], 'b:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,A2[1,:]/sum_A2[1], 'g:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[1]))
pl.loglog(ns,A2[2,:]/sum_A2[2], 'r:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[2]))
pl.loglog(ns,A2[3,:]/sum_A2[3], 'y:')#, label = r'$A^{2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.legend(loc = 'best')
pl.title(r'24w93 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
#pl.savefig('plots/24w93_relative_A_vs_n.pdf')
pl.show()

DA2_l = np.diff(A2, axis = 0)

DA2_n = np.diff(A2, axis = 1)

pl.figure()
pl.semilogx(ns,DA2_l[0,:],  'b-' ,linewidth = 1.0,label = r'$\ell=%2.1f\,nm$'%(1e9*Ls[0]))
pl.semilogx(ns,DA2_l[9,:],  'b--',linewidth = 1.0,label =r'$\ell=%2.1f\,nm$' %(1e9*Ls[9]))
pl.semilogx(ns,DA2_l[24,:], 'b-.',linewidth = 1.0,label =r'$\ell=%2.1f\,nm$'%(1e9*Ls[24]))
pl.semilogx(ns,DA2_l[49,:], 'b:' ,linewidth = 1.0,label =r'$\ell=%2.1f\,nm$'%(1e9*Ls[49]))
pl.semilogx(ns,DA2_l[3,:]-DA2_l[3,:], 'k:')# , linewidth = 1.0, label = r'$\ell=%2.1f\,nm$'%(1e9*Ls[3]))
pl.legend(loc = 'best')
pl.title(r'dA2/dl contribution to Matsubara sum for [5,1] and [26,0]')
pl.ylabel(r'$d\mathcal{A}^{(2)}_{n}/dl$')
pl.xlabel(r'$n$')
pl.show()

pl.figure()
pl.plot(ns,(A0[0,:]+A2[0,:]), 'b-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.plot(ns,(A0[3,:]+A2[3,:]), 'g-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.plot(ns,(A0[6,:]+A2[6,:]), 'r-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[6]))
pl.plot(ns,(A0[9,:]+A2[9,:]), 'y-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[9]))
pl.legend(loc = 'best')
pl.title(r'290w290 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
pl.show()

pl.figure()
pl.loglog(ns,(A0[0,:]+A2[0,:])/(sum_A0[0]+sum_A2[0]), 'b-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[0]))
pl.loglog(ns,(A0[3,:]+A2[3,:])/(sum_A0[3]+sum_A2[3]), 'g-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[3]))
pl.loglog(ns,(A0[6,:]+A2[6,:])/(sum_A0[6]+sum_A2[6]), 'r-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[6]))
pl.loglog(ns,(A0[9,:]+A2[9,:])/(sum_A0[9]+sum_A2[9]), 'y-', label = r'$A^{0,2}(\ell=%2.1f\,nm)$'%(1e9*Ls[9]))
pl.legend(loc = 'best')
pl.title(r'290w290 Matsubara terms')
pl.ylabel(r'$\mathcal{A}^{(0)}_{n}, \,\, \mathcal{A}^{(2)}_{n}$')
pl.xlabel(r'$n$')
pl.show()
